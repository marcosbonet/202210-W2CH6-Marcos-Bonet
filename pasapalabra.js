const questionsOne = [
    {
        letter: 'a',
        answer: 'abducir',
        status: 0,
        question:
            'CON LA A. Dicho de una supuesta criatura extraterrestre: Apoderarse de alguien.',
    },
    {
        letter: 'b',
        answer: 'bingo',
        status: 0,
        question:
            "CON LA B. Juego que ha sacado de quicio a todos los 'Skylabers' en las sesiones de precurso.",
    },
    {
        letter: 'c',
        answer: 'churumbel',
        status: 0,
        question: 'CON LA C. Niño, crío, bebé.',
    },
    {
        letter: 'd',
        answer: 'diarrea',
        status: 0,
        question:
            'CON LA D. Anormalidad en la función del aparato digestivo caracterizada por frecuentes evacuaciones y su consistencia líquida.',
    },
    {
        letter: 'e',
        answer: 'ectoplasma',
        status: 0,
        question:
            'CON LA E. Gelatinoso y se encuentra debajo de la membrana plasmática. Los cazafantasmas medían su radiación.',
    },
    {
        letter: 'f',
        answer: 'facil',
        status: 0,
        question:
            'CON LA F. Que no requiere gran esfuerzo, capacidad o dificultad.',
    },
    {
        letter: 'g',
        answer: 'galaxia',
        status: 0,
        question:
            'CON LA G. Conjunto enorme de estrellas, polvo interestelar, gases y partículas.',
    },
    {
        letter: 'h',
        answer: 'harakiri',
        status: 0,
        question: 'CON LA H. Suicidio ritual japonés por desentrañamiento.',
    },
    {
        letter: 'i',
        answer: 'iglesia',
        status: 0,
        question: 'CON LA I. Templo cristiano.',
    },
    {
        letter: 'j',
        answer: 'jabali',
        status: 0,
        question:
            "CON LA J. Variedad salvaje del cerdo que sale en la película 'El Rey León', de nombre Pumba.",
    },
    {
        letter: 'k',
        answer: 'kamikaze',
        status: 0,
        question:
            'CON LA K. Persona que se juega la vida realizando una acción temeraria.',
    },
    {
        letter: 'l',
        answer: 'licantropo',
        status: 0,
        question: 'CON LA L. Hombre lobo.',
    },
    {
        letter: 'm',
        answer: 'misantropo',
        status: 0,
        question:
            'CON LA M. Persona que huye del trato con otras personas o siente gran aversión hacia ellas.',
    },
    {
        letter: 'n',
        answer: 'necedad',
        status: 0,
        question: 'CON LA N. Demostración de poca inteligencia.',
    },
    {
        letter: 'ñ',
        answer: 'señal',
        status: 0,
        question:
            'CONTIENE LA Ñ. Indicio que permite deducir algo de lo que no se tiene un conocimiento directo.',
    },
    {
        letter: 'o',
        answer: 'orco',
        status: 0,
        question:
            'CON LA O. Humanoide fantástico de apariencia terrible y bestial, piel de color verde creada por el escritor Tolkien.',
    },
    {
        letter: 'p',
        answer: 'protoss',
        status: 0,
        question:
            'CON LA P. Raza ancestral tecnológicamente avanzada que se caracteriza por sus grandes poderes psíonicos del videojuego StarCraft.',
    },
    {
        letter: 'q',
        answer: 'queso',
        status: 0,
        question:
            'CON LA Q. Producto obtenido por la maduración de la cuajada de la leche.',
    },
    { letter: 'r', answer: 'raton', status: 0, question: 'CON LA R. Roedor.' },
    {
        letter: 's',
        answer: 'stackoverflow',
        status: 0,
        question:
            'CON LA S. Comunidad salvadora de todo desarrollador informático.',
    },
    {
        letter: 't',
        answer: 'terminator',
        status: 0,
        question:
            'CON LA T. Película del director James Cameron que consolidó a Arnold Schwarzenegger como actor en 1984.',
    },
    {
        letter: 'u',
        answer: 'unamuno',
        status: 0,
        question:
            "CON LA U. Escritor y filósofo español de la generación del 98 autor del libro 'Niebla' en 1914.",
    },
    {
        letter: 'v',
        answer: 'vikingos',
        status: 0,
        question:
            'CON LA V. Nombre dado a los miembros de los pueblos nórdicos originarios de Escandinavia, famosos por sus incursiones y pillajes en Europa.',
    },
    {
        letter: 'w',
        answer: 'sandwich',
        status: 0,
        question:
            'CONTIENE LA W. Emparedado hecho con dos rebanadas de pan entre las cuales se coloca jamón y queso.',
    },
    {
        letter: 'x',
        answer: 'botox',
        status: 0,
        question:
            'CONTIENE LA X. Toxina bacteriana utilizada en cirujía estética.',
    },
    {
        letter: 'y',
        answer: 'peyote',
        status: 0,
        question:
            'CONTIENE LA Y. Pequeño cáctus conocido por sus alcaloides psicoactivos utilizado de forma ritual y medicinal por indígenas americanos.',
    },
    {
        letter: 'z',
        answer: 'zen',
        status: 0,
        question:
            'CON LA Z. Escuela de budismo que busca la experiencia de la sabiduría más allá del discurso racional.',
    },
];

const questionsTwo = [
    {
        letter: 'a',
        answer: 'arteria',
        status: 0,
        question:
            'CON LA A. Conducto por donde va la sangre desde el corazón a las demás partes del cuerpo.',
    },
    {
        letter: 'b',
        answer: 'bitácora',
        status: 0,
        question:
            'CON LA B. En los barcos, especie de armario que está fijo en la cubierta y situado muy cerca del timón donde se pone la brújula.',
    },
    {
        letter: 'c',
        answer: 'cicerone',
        status: 0,
        question:
            'CON LA C. Persona que sirve a otras de guía y les va enseñando y explicando lugares y cosas interesantes.',
    },
    {
        letter: 'd',
        answer: 'diplomacia',
        status: 0,
        question:
            'CON LA D. Actividad que realiza un país para mantener buenas relaciones con el resto de países.',
    },
    {
        letter: 'e',
        answer: 'equinoccio',
        status: 0,
        question:
            'CON LA E. Cada uno de los dos momentos del año en que, por estar el Sol sobre el ecuador, los días y las noches duran lo mismo en toda la Tierra.',
    },
    {
        letter: 'f',
        answer: 'fisiología',
        status: 0,
        question:
            'CON LA F. Ciencia que estudia las funciones de los órganos de los seres vivos.',
    },
    {
        letter: 'g',
        answer: 'glaciación',
        status: 0,
        question:
            'CON LA G. Cada una de las épocas, hace miles de años, en las que hacía mucho más frío que en la actualidad y gran parte de la Tierra estaba cubierta por hielo.',
    },
    {
        letter: 'h',
        answer: 'hinojo',
        status: 0,
        question:
            'CON LA H. Planta de flores amarillas que se usa como condimento, por el sabor de sus frutos parecido al del anís, y también en medicina porque ayuda a hacer la digestión.',
    },
    {
        letter: 'i',
        answer: 'ingenio',
        status: 0,
        question:
            'CON LA I. Capacidad para inventar cosas o para pensar y hablar con gracia.',
    },
    {
        letter: 'j',
        answer: 'jade',
        status: 0,
        question:
            'CON LA J. Mineral muy duro, de color verde o blanquecino, que se emplea en joyería y para hacer objetos de adorno.',
    },
    {
        letter: 'k',
        answer: 'karate',
        status: 0,
        question:
            'CON LA K. Lucha de origen japonés que consiste sobre todo en el combate con manos y pies.',
    },
    {
        letter: 'l',
        answer: 'lema',
        status: 0,
        question:
            'CON LA L. Frase que expresa la forma en que debe actuar una persona.',
    },
    {
        letter: 'm',
        answer: 'miriñaque',
        status: 0,
        question:
            'CON LA M. Prenda rígida o almidonada, a veces con aros, que antiguamente llevaban las mujeres bajo la falda para darle vuelo.',
    },
    {
        letter: 'n',
        answer: 'ninfa',
        status: 0,
        question:
            'CON LA N. En las leyendas mitológicas, diosa con forma de muchacha que vivía en los bosques, las fuentes o los ríos.',
    },
    {
        letter: 'ñ',
        answer: 'ñandú',
        status: 0,
        question:
            'CONTIENE LA Ñ. Ave parecida al avestruz, pero más pequeña y con tres dedos en cada pie.',
    },
    {
        letter: 'o',
        answer: 'onomatopeya',
        status: 0,
        question:
            'CON LA O. Palabra que imita el sonido que hace un animal o una cosa.',
    },
    {
        letter: 'p',
        answer: 'pabellón',
        status: 0,
        question:
            'CON LA P. Edificio que es parte de un conjunto, de otro edificio más grande, o que está muy cerca de él.',
    },
    {
        letter: 'q',
        answer: 'quimera',
        status: 0,
        question:
            'CON LA Q. Cosa que, sin ser real, alguien la imagina como posible o verdadera.',
    },
    {
        letter: 'r',
        answer: 'rémora',
        status: 0,
        question:
            'CON LA R. Pez marino que tiene una especie de ventosa en la cabeza con la que se fija a otros peces más grandes.',
    },
    {
        letter: 's',
        answer: 'sotana',
        status: 0,
        question:
            'CON LA S. Traje negro y largo parecido a una túnica que llevan algunos curas y religiosos.',
    },
    {
        letter: 't',
        answer: 'testamento',
        status: 0,
        question:
            'CON LA T. Escrito o declaración de palabra en el que alguien dice lo que quiere que se haga después de su muerte, sobre todo con su dinero o sus pertenencias.',
    },
    {
        letter: 'u',
        answer: 'urbanización',
        status: 0,
        question:
            'CON LA U. Conjunto de casas y edificios que suelen ser parecidos y donde hay tiendas, parques y otros espacios que necesitan las personas que allí viven.',
    },
    {
        letter: 'v',
        answer: 'vencejo',
        status: 0,
        question:
            'CON LA V. Pájaro de color casi siempre negro o pardo que tiene el pico delgado, las alas muy largas y la cola en forma de horquilla. Vuela muy rápido.',
    },
    {
        letter: 'w',
        answer: 'whisky',
        status: 0,
        question:
            'CONTIENE LA W. Licor con mucho alcohol que se hace al fermentar la cebada o algunos otros cereales.',
    },
    {
        letter: 'x',
        answer: 'xilografía',
        status: 0,
        question:
            'CONTIENE LA X. Manera de hacer grabados sobre madera, dejando vacías las partes que deben quedar blancas en el dibujo.',
    },
    {
        letter: 'y',
        answer: 'yak',
        status: 0,
        question:
            'CONTIENE LA Y. Mamífero de gran tamaño parecido a un toro, pero con el cuero cubierto de un abundante pelo que lo protege del frío.',
    },
    {
        letter: 'z',
        answer: 'zócalo',
        status: 0,
        question:
            'CON LA Z. Banda más o menos ancha, cubierta de otro material o pintada, que hay en la parte baja de las paredes de una habitación.',
    },
];

const questionsThree = [
    {
        letter: 'a',
        answer: 'ascua',
        status: 0,
        question:
            'CON LA A. Trozo de cualquier material ardiendo pero sin llama.',
    },
    {
        letter: 'b',
        answer: 'bilis',
        status: 0,
        question:
            'CON LA B. Líquido amargo de color amarillo verdoso producido por el hígado y que ayuda a la digestión de los alimentos.',
    },
    {
        letter: 'c',
        answer: 'cubismo',
        status: 0,
        question:
            'CON LA C. Estilo de pintura que comenzó en Francia a principios de este siglo y que se caracteriza por representar figuras y objetos mediante formas geométricas.',
    },
    {
        letter: 'd',
        answer: 'diéresis',
        status: 0,
        question:
            'CON LA D. Signo ortográfico que se coloca encima de la u para indicar que esta letra ha de pronunciarse.',
    },
    {
        letter: 'e',
        answer: 'estría',
        status: 0,
        question:
            'CON LA E. Línea que se forma en la piel cuando ésta se ha estirado excesivamente.',
    },
    {
        letter: 'f',
        answer: 'fonema',
        status: 0,
        question: 'CON LA F. Sonido de una letra.',
    },
    {
        letter: 'g',
        answer: 'gaucho',
        status: 0,
        question:
            'CON LA G. Se dice de las personas que viven en las grandes llanuras de Argentina y Uruguay y llevan el ganado de un lado a otro.',
    },
    {
        letter: 'h',
        answer: 'himno',
        status: 0,
        question:
            'CON LA H. Poesía o composición musical en alabanza de alguien o algo, como la que se dedica a un país.',
    },
    {
        letter: 'i',
        answer: 'imán',
        status: 0,
        question:
            'CON LA I. Mineral capaz de atraer el hierro u otros metales.',
    },
    {
        letter: 'j',
        answer: 'jabato',
        status: 0,
        question: 'CON LA J. Cría del jabalí.',
    },
    {
        letter: 'k',
        answer: 'kilómetro',
        status: 0,
        question: 'CON LA K. Unidad de longitud que equivale a 1000 metros.',
    },
    {
        letter: 'l',
        answer: 'lombriz',
        status: 0,
        question:
            'CON LA L. Gusano muy largo de color rojizo que se alimenta de sustancias que hay en la tierra.',
    },
    {
        letter: 'm',
        answer: 'mudéjar',
        status: 0,
        question:
            'CON LA M. Nombre que se daba a los musulmanes que vivían en los reinos cristianos de la península ibérica.',
    },
    {
        letter: 'n',
        answer: 'nogal',
        status: 0,
        question:
            'CON LA N. Árbol grande con la corteza lisa y de color gris cuyo fruto es la nuez.',
    },
    {
        letter: 'ñ',
        answer: 'ñoño',
        status: 0,
        question: 'CONTIENE LA Ñ. Cursi o demasiado delicado.',
    },
    {
        letter: 'o',
        answer: 'ocre',
        status: 0,
        question:
            'CON LA O. Se dice del color que es una mezcla de amarillo y marrón.',
    },
    {
        letter: 'p',
        answer: 'protocolo',
        status: 0,
        question:
            'CON LA P. Conjunto de reglas o ceremonias que hay que cumplir en los actos oficiales o solemnes.',
    },
    {
        letter: 'q',
        answer: 'quechua',
        status: 0,
        question:
            'CON LA Q. Pueblo indio que habita en Perú y que vivía allí antes del descubrimiento de América.',
    },
    {
        letter: 'r',
        answer: 'repisa',
        status: 0,
        question:
            'CON LA R. Tabla o elemento similar que se coloca contra la pared para poner en ella objetos.',
    },
    {
        letter: 's',
        answer: 'solsticio',
        status: 0,
        question:
            'CON LA S. Nombre de dos momentos del año que marcan el inicio del verano y el comienzo del invierno.',
    },
    {
        letter: 't',
        answer: 'troposfera',
        status: 0,
        question:
            'CON LA T. Capa de la atmósfera más cercana a la superficie de la Tierra, en la que tienen lugar los fenómenos del tiempo meteorológico.',
    },
    {
        letter: 'u',
        answer: 'utopía',
        status: 0,
        question:
            'CON LA U. Algo que es bueno y que deseamos pero que es imposible o muy difícil de realizar.',
    },
    {
        letter: 'v',
        answer: 'visera',
        status: 0,
        question:
            'CON LA V. Parte hacia afuera que tienen las gorras por delante y que sirve para que el sol no nos haga daño en los ojos.',
    },
    {
        letter: 'w',
        answer: 'western',
        status: 0,
        question: 'CONTIENE LA W. Película del oeste americano.',
    },
    {
        letter: 'x',
        answer: 'xenófobia',
        status: 0,
        question: 'CONTIENE LA X. Odio o antipatía hacia los extranjeros.',
    },
    {
        letter: 'y',
        answer: 'yodo',
        status: 0,
        question:
            'CONTIENE LA Y. Elemento químico de color oscuro que se encuentra en el suelo en forma de sales, así como en las algas y otros animales marinos.',
    },
    {
        letter: 'z',
        answer: 'zarzal',
        status: 0,
        question: 'CON LA Z. Lugar donde hay muchas zarzas.',
    },
];

let userName;
let usedWord;
let currentPosition = 0;
let isPlaying = true;
let finalScore = 0;
let questions = [];

const scoreRanking = [
    { name: 'Diego', points: 23 },
    { name: 'Susana', points: 14 },
    { name: 'Mercedes', points: 10 },
    { name: 'Iván', points: 5 },
];

let nameHTML;
let playButton;
let answerHTML;
let questionHTML;
let lettersHTML;
let gamerHTML;
let endButton;
let scoreRankingHTML;
let finalScoreHTML;
let seconds = 150;

const circles = document.querySelectorAll('.letter');
const container = document.getElementById('main-container');
const n = 27;
const r = 300;

let angulo = -Math.PI / 2;

let letterHeight = circles[0].getBoundingClientRect().height;
let letterWidth = circles[0].getBoundingClientRect().width;
let originX =
    container.getBoundingClientRect().left +
    container.getBoundingClientRect().width / 2 -
    letterWidth / 5;
let originY =
    container.getBoundingClientRect().top +
    container.getBoundingClientRect().height / 2 -
    letterHeight / 5 +
    11;

setInterval(() => {
    circles.forEach((element, i) => {
        element.style.left = `${
            originX + r * Math.cos(angulo + ((2 * Math.PI) / n) * i)
        }px`;
        element.style.top = `${
            originY + r * Math.sin(angulo + ((2 * Math.PI) / n) * i)
        }px`;
    });
    letterHeight = circles[0].getBoundingClientRect().height;
    letterWidth = circles[0].getBoundingClientRect().width;
    originX =
        container.getBoundingClientRect().left +
        container.getBoundingClientRect().width / 2 -
        letterWidth / 5;
    originY =
        container.getBoundingClientRect().top +
        container.getBoundingClientRect().height / 2 -
        letterHeight / 5 +
        11;
}, 20);

const main = () => {
    document.getElementById('two').style.display = 'none';
    document.getElementById('three').style.display = 'none';
    nameHTML = document.getElementById('insert-name');
    playButton = document.getElementById('button-one');
    answerHTML = document.getElementById('answers');
    questionHTML = document.getElementById('questions');
    lettersHTML = document.getElementsByClassName('letter');
    endButton = document.getElementById('end');
    gamerHTML = document.getElementById('gamer');
    scoreRankingHTML = document.getElementById('scoreRanking');
    finalScoreHTML = document.getElementById('score');
    playButton.addEventListener('click', getName);
    nameHTML.addEventListener('keypress', getNameKeyboard);
    answerHTML.addEventListener('keypress', checkWord);
    endButton.addEventListener('click', endGame);
};

const endGame = () => {
    isPlaying = false;
    document.getElementById('two').style.display = 'none';
    document.getElementById('two').style.visibility = 'hidden';
    document.getElementById('three').style.display = 'block';
    document.getElementById('three').style.visibility = 'visible';
    lettersHTML[currentPosition].style.boxShadow = 'none';
    loadScores();
};

const getName = () => {
    const nameHTML = document.getElementById('insert-name');
    userName = nameHTML.value;
    if (userName === null || userName.trim().length === 0) {
        alert('Por favor, introduce un nombre válido.');
    } else {
        document.getElementById('one').style.display = 'none';
        document.getElementById('one').style.visibility = 'hidden';
        document.getElementById('two').style.display = 'block';
        document.getElementById('two').style.visibility = 'visible';
        startGame();
    }
};

const getNameKeyboard = (e) => {
    let pressedKey = e.code;
    if (pressedKey === 'Enter') {
        getName();
    }
};

const startGame = () => {
    randomGame();
    isPlaying = true;
    questionHTML.textContent = questions[currentPosition].question;
    lettersHTML[0].style.boxShadow = '0 0 15px 3px #fff';
    gamerHTML.textContent = 'Jugador(a): ' + userName;
    updateTimer();
};

const updateTimer = () => {
    document.getElementById('timer').textContent = seconds;
    if (seconds === 0 && isPlaying === true) {
        alert('¡Vaya, el tiempo ha terminado!');
        endGame();
    } else if (isPlaying) {
        seconds--;
        setTimeout(updateTimer, 1000);
    }
};

const randomGame = () => {
    for (let i = 0; i < questionsOne.length; i++) {
        let randomNumber = Math.floor(Math.random() * 3);
        if (randomNumber === 0) {
            questions.push(questionsOne[i]);
        } else if (randomNumber === 1) {
            questions.push(questionsTwo[i]);
        } else {
            questions.push(questionsThree[i]);
        }
    }
};

const checkWord = (e) => {
    let pressedKey = e.code;
    usedWord = answerHTML.value;
    if (pressedKey === 'Enter') {
        if (usedWord.toLowerCase() === '') {
            alert('Espacio vacío. Escribe tu respuesta.');
        } else if (
            usedWord.toLowerCase() === questions[currentPosition].answer
        ) {
            lettersHTML[currentPosition].style.backgroundColor = '#77dd77';
            answerHTML.value = '';
            answerHTML.placeholder = 'Escribe tu respuesta';
            questions[currentPosition].status = 1;
            lettersHTML[currentPosition].style.boxShadow = 'none';
            nextPosition();
            lettersHTML[currentPosition].style.boxShadow = '0 0 15px 3px #fff';
        } else {
            lettersHTML[currentPosition].style.backgroundColor = '#ff6961';
            answerHTML.value = '';
            answerHTML.placeholder = 'Escribe tu respuesta';
            questions[currentPosition].status = 2;
            lettersHTML[currentPosition].style.boxShadow = 'none';
            nextPosition();
            lettersHTML[currentPosition].style.boxShadow = '0 0 15px 3px #fff';
        }
        questionHTML.textContent = questions[currentPosition].question;
    } else if (pressedKey === 'Space') {
        answerHTML.value = '';
        answerHTML.placeholder = 'Escribe tu respuesta';
        answerHTML.rows = 1;
        lettersHTML[currentPosition].style.boxShadow = 'none';
        nextPosition();
        lettersHTML[currentPosition].style.boxShadow = '0 0 15px 3px #fff';
        questionHTML.textContent = questions[currentPosition].question;
    }
    if (isPlaying === false) {
        lettersHTML[currentPosition].style.boxShadow = 'none';
    }
};

const nextPosition = () => {
    do {
        currentPosition++;
        if (currentPosition === 27) {
            currentPosition = 0;
        }
    } while (questions[currentPosition].status !== 0 && checkNotFinish());
};

const checkNotFinish = () => {
    for (let i = 0; i < questions.length && isPlaying === true; i++) {
        if (questions[i].status === 0) {
            return true;
        }
    }
    isPlaying = false;
    document.getElementById('two').style.display = 'none';
    document.getElementById('two').style.visibility = 'hidden';
    document.getElementById('three').style.display = 'block';
    document.getElementById('three').style.visibility = 'visible';
    loadScores();
};

const userScore = () => {
    for (let i = 0; i < questions.length; i++) {
        if (questions[i].status === 1) {
            finalScore++;
        }
    }
};

const addScore = () => {
    for (let i = 0; i < scoreRanking.length; i++) {
        if (scoreRanking[i].points < finalScore) {
            scoreRanking.splice(i, 0, { name: userName, points: finalScore });
            return;
        }
    }
    scoreRanking.push({ name: userName, points: finalScore });
};

const loadScores = () => {
    userScore();
    addScore();
    finalScoreHTML.textContent = finalScore;
    let fragmentHTML =
        '<tr><td id=name>Nombre</td><td id=score>Puntos</td></tr>';
    for (i in scoreRanking) {
        fragmentHTML += `<tr><td>${scoreRanking[i].name}</td><td>${scoreRanking[i].points}</td></tr>`;
    }
    scoreRankingHTML.innerHTML = fragmentHTML;
};

main();
